"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const fs_1 = require("fs");
const spawn_wrap_1 = require("spawn-wrap");
const moduleName = process.env.__WRAP_CMD__;
delete process.env.__WRAP_CMD__;
function die(msg) {
    console.log(msg);
    console.error(msg);
    return process.exit(1);
}
if (moduleName == null)
    die("Invalid usage of <haxec>, no wrap module provided!");
if (!fs_1.existsSync(moduleName))
    die(`Invalid usage of <haxec>, no wrap module ${moduleName} not found!`);
const { before, after } = require(moduleName);
before && typeof before === 'function' && before();
process.on("exit", code => {
    after && typeof after === 'function' && after(code);
});
spawn_wrap_1.runMain();
